using EasyHttp.ViewModel;
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace EasyHttp.Model
{
    public class FileHeader
    {
        public static List<KeyValue> FileList { get; private set; } = new List<KeyValue>()
        {
            new KeyValue("7z","377ABCAF271C"),
            new KeyValue("RAR","526172"),
            new KeyValue("rar","52617221"),
            new KeyValue("aba","00014241"),
            new KeyValue("abi","414F4C494E444558"),
            new KeyValue("aby","414F4C4442"),
            new KeyValue("accdb","000100005374616E6461726420414345204442"),
            new KeyValue("ACM","4D5A"),
            new KeyValue("ADF","444F53"),
            new KeyValue("adx","0300000041505052"),
            new KeyValue("AIFF","464F524D00"),
            new KeyValue("ain","2112"),
            new KeyValue("ami","5B7665725D"),
            new KeyValue("amr","2321414D52"),
            new KeyValue("ANI","52494646"),
            new KeyValue("API","4D5A900003000000"),
            new KeyValue("arc","1A0x"),
            new KeyValue("arc","41724301"),
            new KeyValue("arj","60EA"),
            new KeyValue("ARJ","60EA27"),
            new KeyValue("ART","4A47030E000000"),
            new KeyValue("ART","4A47040E000000"),
            new KeyValue("asf","3026B2758E66CF11"),
            new KeyValue("asf","3026B2758E66CF11A6D900AA0062CE6C"),
            new KeyValue("asx","3C"),
            new KeyValue("au","2E736E64"),
            new KeyValue("avi","41564920"),
            new KeyValue("AX","4D5A"),
            new KeyValue("AX","4D5A900003000000"),
            new KeyValue("bag","414F4C2046656564626167"),
            new KeyValue("BAS","202020"),
            new KeyValue("bin","424C4932323351"),
            new KeyValue("bmp","424D"),
            new KeyValue("BMP","424D3E"),
            new KeyValue("bz","425A68"),
            new KeyValue("BZ2","425A68"),
            new KeyValue("CAB","495363"),
            new KeyValue("CAB","49536328"),
            new KeyValue("CAB","4D534346"),
            new KeyValue("CBD","434246494C45"),
            new KeyValue("CCD","5B436C"),
            new KeyValue("cdr","CDR"),
            new KeyValue("CDR","454C49544520436F6D6D616E64657220"),
            new KeyValue("CDR","4D535F564F494345"),
            new KeyValue("CHI","49545346"),
            new KeyValue("CHM","495453"),
            new KeyValue("CLB","434D5831"),
            new KeyValue("CLB","434F4D2B"),
            new KeyValue("cnt","3A42617365"),
            new KeyValue("COM","4D5AEE"),
            new KeyValue("COM","E93B03"),
            new KeyValue("CPE","464158434F5645522D564552"),
            new KeyValue("CPL","4D5A"),
            new KeyValue("CPT","4350543746494C45"),
            new KeyValue("CPT","43505446494C45"),
            new KeyValue("CPX","5B5769"),
            new KeyValue("cru","4352555348"),
            new KeyValue("CRU","43525553482076"),
            new KeyValue("CRW","49491A00000048454150434344520200"),
            new KeyValue("CTF","436174616C6F6720332E303000"),
            new KeyValue("CUR","0000020001002020"),
            new KeyValue("dat","1A52545320434F4D5052455353454420494D4147452056312E301A"),
            new KeyValue("dat","415647365F496E746567726974795F4461746162617365"),
            new KeyValue("DAT","43524547"),
            new KeyValue("DAT","436C69656E742055726C4361636865204D4D462056657220"),
            new KeyValue("DAT","45524653534156454441544146494C45"),
            new KeyValue("DAT","496E6E6F20536574757020556E696E7374616C6C204C6F6720286229"),
            new KeyValue("db","0006156100000002000004D200001000"),
            new KeyValue("DB","44424648"),
            new KeyValue("dba","00014244"),
            new KeyValue("dbx","CFAD12FE"),
            new KeyValue("dbx","CFAD12FEC5FD746F"),
            new KeyValue("dci","3C21646F63747970"),
            new KeyValue("dcx","3ADE68B1"),
            new KeyValue("DDB","000100"),
            new KeyValue("dib","424D"),
            new KeyValue("DLL","4D5A90"),
            new KeyValue("DMP","4D444D5093A7"),
            new KeyValue("DMS","444D5321"),
            new KeyValue("doc","0D444F43"),
            new KeyValue("doc","1234567890FF"),
            new KeyValue("doc","31BE000000AB0000"),
            new KeyValue("doc","7FFE340A"),
            new KeyValue("dot","D0CF11E0"),
            new KeyValue("doc","D0CF11E0A1B11AE1"),
            new KeyValue("DPL","4D5A50"),
            new KeyValue("DRV","4D5A16"),
            new KeyValue("drw","01FF02040302"),
            new KeyValue("ds4","4D47582069747064"),
            new KeyValue("DSN","4D56"),
            new KeyValue("dsp","23204D6963726F736F667420446576656C6F7065722053747564696F"),
            new KeyValue("dss","02647373"),
            new KeyValue("dtd","0764743264647464"),
            new KeyValue("dtd","3C21454E54495459"),
            new KeyValue("DVR","445644"),
            new KeyValue("dwg","414331"),
            new KeyValue("ECO","2A5052"),
            new KeyValue("elf","7F454C4601010100"),
            new KeyValue("emf","0100000058000000"),
            new KeyValue("eml","44656C69766572792D646174653A"),
            new KeyValue("EML","46726F6D202020"),
            new KeyValue("EML","46726F6D203F3F3F"),
            new KeyValue("EML","46726F6D3A20"),
            new KeyValue("EML","526563"),
            new KeyValue("enc","005C41B1FF"),
            new KeyValue("eps","25215053"),
            new KeyValue("eps","252150532D41646F6265"),
            new KeyValue("eps","252150532D41646F62652D332E3020455053462D332030"),
            new KeyValue("EPS","C5D0D3"),
            new KeyValue("eth","1A350100"),
            new KeyValue("evt","300000004C664C65"),
            new KeyValue("evt","03000000C466C456"),
            new KeyValue("EVTX","456C6646696C6500"),
            new KeyValue("exe","4D5A"),
            new KeyValue("exe","4D5A"),
            new KeyValue("exe","4D5A"),
            new KeyValue("EXE,DLL,OCX,OLB,IMM,IME","4D5A90"),
            new KeyValue("fli","0011AF"),
            new KeyValue("flt","000101"),
            new KeyValue("FLT","4D5A900003000000"),
            new KeyValue("FLV","464C5601"),
            new KeyValue("fm","3C4D616B657246696C6520"),
            new KeyValue("fm3","00001A0007800100"),
            new KeyValue("fmt","20006800200"),
            new KeyValue("FNT","434841"),
            new KeyValue("FON","4D5A"),
            new KeyValue("GBC","87F53E"),
            new KeyValue("gid","3F5F0300"),
            new KeyValue("GID","4C4E0200"),
            new KeyValue("GIF","47494638"),
            new KeyValue("gif","474946383761"),
            new KeyValue("gif","474946383961"),
            new KeyValue("GTD","7B5072"),
            new KeyValue("GX2","475832"),
            new KeyValue("gz","1F8B"),
            new KeyValue("gz","1F8B08"),
            new KeyValue("hap","91334846"),
            new KeyValue("HDMP","4D444D5093A7"),
            new KeyValue("hdr","233F52414449414E43450A"),
            new KeyValue("HLP","3F5F03"),
            new KeyValue("hlp","3F5F0300"),
            new KeyValue("HLP","4C4E0200"),
            new KeyValue("hqx","28546869732066696C65"),
            new KeyValue("hqx","28546869732066696C65206D75737420626520636F6E76657274656420776974682042696E48657820"),
            new KeyValue("HTM","3C2144"),
            new KeyValue("html","3C21444F4354"),
            new KeyValue("html","3C48544D4C3E"),
            new KeyValue("html","3C68746D6C3E"),
            new KeyValue("html","68746D6C3E"),
            new KeyValue("ico","0000010000"),
            new KeyValue("ico","0000010001002020"),
            new KeyValue("IFF","464F524D"),
            new KeyValue("IFO","445644"),
            new KeyValue("IME","4D5A90"),
            new KeyValue("img","000100080001000101"),
            new KeyValue("IMG","00FFFF"),
            new KeyValue("IMM","4D5A90"),
            new KeyValue("ind","414F4C494458"),
            new KeyValue("ISO","4344303031"),
            new KeyValue("ivr","2E524543"),
            new KeyValue("JAR","4A4152435300"),
            new KeyValue("jar","5F27A889"),
            new KeyValue("jpg","FFD8FF"),
            new KeyValue("jpg","FFD8FFE000"),
            new KeyValue("jpg","FFD8FFE0"),
            new KeyValue("jpg","FFD8FFFE00"),
            new KeyValue("KGB","4B47425F61726368202D"),
            new KeyValue("KOZ","49443303000000"),
            new KeyValue("LDB","42494C"),
            new KeyValue("lha","2D6C68352D"),
            new KeyValue("LHP","3F5F03"),
            new KeyValue("lhp","3F5F0300"),
            new KeyValue("lib","213C617263683E0A"),
            new KeyValue("LIB","2A2420"),
            new KeyValue("LIT","49544F4C49544C53"),
            new KeyValue("LNK","4C0000"),
            new KeyValue("lnk","4C000000"),
            new KeyValue("lnk","4C000000011402"),
            new KeyValue("LNK","4C00000001140200"),
            new KeyValue("log","2A2A2A2020496E7374616C6C6174696F6E205374617274656420"),
            new KeyValue("lzh","lh"),
            new KeyValue("lwp","576F726450726F"),
            new KeyValue("m3u","234558"),
            new KeyValue("m4a","00000020667479704D34412000000000"),
            new KeyValue("m4a","00000020667479704D34412000000000"),
            new KeyValue("manifest","3C3F786D6C2076657273696F6E3D"),
            new KeyValue("MAR","4D41523100"),
            new KeyValue("MAR","4D415243"),
            new KeyValue("MAR","4D41723000"),
            new KeyValue("max","D0CF11"),
            new KeyValue("mdb","000100005374616E64617264204A6574204442"),
            new KeyValue("mdb","5374616E64617264204A"),
            new KeyValue("MDF","00FFFF"),
            new KeyValue("mdf","00FFFFFFFFFFFFFFFFFFFF0000020001"),
            new KeyValue("mdf","010F0000"),
            new KeyValue("MDI","4550"),
            new KeyValue("MDS","4D4544"),
            new KeyValue("MID","4D546864"),
            new KeyValue("mkv","1A45DFA3934282886D6174726F736B61"),
            new KeyValue("MLS","4D494C4553"),
            new KeyValue("MLS","4D4C5357"),
            new KeyValue("MLS","4D56323134"),
            new KeyValue("MLS","4D563243"),
            new KeyValue("MMF","4D4D4D440000"),
            new KeyValue("mny","000100004D534953414D204461746162617365"),
            new KeyValue("MOV","00000F"),
            new KeyValue("MOV","000077"),
            new KeyValue("mov","6D6F6F76"),
            new KeyValue("mov","6D646174"),
            new KeyValue("mp","0CED"),
            new KeyValue("MP3","494433"),
            new KeyValue("MP3","FFFB50"),
            new KeyValue("mp4","000000186674797033677035"),
            new KeyValue("MPA","000001"),
            new KeyValue("mpg","000001B3"),
            new KeyValue("mpg","000001BA"),
            new KeyValue("MSC","3C3F78"),
            new KeyValue("msc","3C3F786D6C2076657273696F6E3D22312E30223F3E0D0A3C4D4D435F436F6E736F6C6546696C6520436F6E736F6C6556657273696F6E3D22"),
            new KeyValue("msi","2320"),
            new KeyValue("MSV","4D535F564F494345"),
            new KeyValue("NES","4E4553"),
            new KeyValue("NLS","C22020"),
            new KeyValue("nri","0E4E65726F49534F"),
            new KeyValue("ntf","1A0000"),
            new KeyValue("nsf","1A0000030000"),
            new KeyValue("nsf","1A00000300001100"),
            new KeyValue("nsf","1A0000040000"),
            new KeyValue("ntf","30314F52444E414E43452053555256455920202020202020"),
            new KeyValue("obj","4C01"),
            new KeyValue("OCX","4D5A"),
            new KeyValue("OCX","4D5A90"),
            new KeyValue("OLB","4D5A"),
            new KeyValue("OLB","4D5A90"),
            new KeyValue("org","414F4C564D313030"),
            new KeyValue("pak","1A0B"),
            new KeyValue("PAT","4746315041544348"),
            new KeyValue("PAT","47504154"),
            new KeyValue("PBK","5B4144"),
            new KeyValue("PCB","17A150"),
            new KeyValue("PCS","0A0501"),
            new KeyValue("pcx","0Ann0101"),
            new KeyValue("pcx","0A050108"),
            new KeyValue("PDF","255044"),
            new KeyValue("pdf","25504446"),
            new KeyValue("pdf","255044462D312E"),
            new KeyValue("PDG","484802"),
            new KeyValue("pf","1100000053434341"),
            new KeyValue("pic","0100000001"),
            new KeyValue("PJT","000007"),
            new KeyValue("PLL","24536F"),
            new KeyValue("PNG","89504E"),
            new KeyValue("PNG","89504E47"),
            new KeyValue("png","89504E470D0A"),
            new KeyValue("png","89504E470D0A1A0A"),
            new KeyValue("PPC","526563"),
            new KeyValue("PPT","D0CF11"),
            new KeyValue("ppt","006E1EF0"),
            new KeyValue("ppt","0F00E803"),
            new KeyValue("PPZ","4D534346"),
            new KeyValue("prc","424F4F4B4D4F4249"),
            new KeyValue("PRG","234445"),
            new KeyValue("ps","252150532D41646F6265"),
            new KeyValue("PSD","384250"),
            new KeyValue("psd","38425053"),
            new KeyValue("psp","7E424B00"),
            new KeyValue("pst","2142444E"),
            new KeyValue("pwl","E3828596"),
            new KeyValue("qbb","458600000600"),
            new KeyValue("qdf","AC9EBD8F"),
            new KeyValue("qph","03000000"),
            new KeyValue("qt","6D646174"),
            new KeyValue("qxd","00004949585052"),
            new KeyValue("qxd","00004D4D585052"),
            new KeyValue("ra","2E524D460000001200"),
            new KeyValue("ra","2E7261FD"),
            new KeyValue("ra","2E7261FD00"),
            new KeyValue("RAW","060500"),
            new KeyValue("reg","5245474544495434"),
            new KeyValue("rgb","01DA01010003"),
            new KeyValue("RM","2E524D"),
            new KeyValue("rm","2E524D46"),
            new KeyValue("rpm","EDABEEDB"),
            new KeyValue("RTD","43232B44A4434DA5486472"),
            new KeyValue("RTF","7B5C72"),
            new KeyValue("rtf","7B5C727466"),
            new KeyValue("sav","24464C3240282329205350535320444154412046494C45"),
            new KeyValue("SBV","46454446"),
            new KeyValue("SCH","2A7665"),
            new KeyValue("scm","805343"),
            new KeyValue("SH3","4848474231"),
            new KeyValue("SHD","4B490000"),
            new KeyValue("sit","53495421"),
            new KeyValue("sit","53747566664974"),
            new KeyValue("sle","3A56455253494F4E"),
            new KeyValue("sle","414376"),
            new KeyValue("sly","53520100"),
            new KeyValue("SMD","00FFFF"),
            new KeyValue("snm","001E849000000000"),
            new KeyValue("SNP","4D534346"),
            new KeyValue("sol","00BF"),
            new KeyValue("spl","00000100"),
            new KeyValue("SCR","4D5A"),
            new KeyValue("SUB","FFFFFF"),
            new KeyValue("SWF","435753"),
            new KeyValue("SWF","465753"),
            new KeyValue("sxc","calc"),
            new KeyValue("sxd","draw"),
            new KeyValue("sxi","impress"),
            new KeyValue("sxm","math"),
            new KeyValue("sxw","writer"),
            new KeyValue("syw","414D594F"),
            new KeyValue("TAG","000002"),
            new KeyValue("tar","303730373037"),
            new KeyValue("tar.z","1F9D90"),
            new KeyValue("tga","0000100000"),
            new KeyValue("TGA","000002"),
            new KeyValue("tga","0000020000"),
            new KeyValue("TIF","492049"),
            new KeyValue("tif","49492A"),
            new KeyValue("tif","49492A00"),
            new KeyValue("TIF","4D4D002A"),
            new KeyValue("tif","4D4D2A"),
            new KeyValue("TIF","4D4D002B"),
            new KeyValue("TLB","4D53465402000100"),
            new KeyValue("tr1","0110"),
            new KeyValue("TST","000100"),
            new KeyValue("TTF","000100"),
            new KeyValue("ufa","554641"),
            new KeyValue("VBX","4D5A"),
            new KeyValue("VCD","454E5452595643440200000102001858"),
            new KeyValue("vcf","424547494E3A56434152440D0A"),
            new KeyValue("vob","000001BA"),
            new KeyValue("VXD","4D5A"),
            new KeyValue("WAV","524946"),
            new KeyValue("wav","57415645"),
            new KeyValue("wav","57415645666D74"),
            new KeyValue("wb2","00000200"),
            new KeyValue("wk1","2000604060"),
            new KeyValue("wk1","0000020006040600080000000000"),
            new KeyValue("wk3","00001A0000100400"),
            new KeyValue("wk4","00001A0002100400"),
            new KeyValue("wks","0E574B53"),
            new KeyValue("WMA","3026B2"),
            new KeyValue("wmf","01000900"),
            new KeyValue("wmf","010009000003"),
            new KeyValue("wmf","02000900"),
            new KeyValue("wmf","D7CDC69A"),
            new KeyValue("WMV","3026B2"),
            new KeyValue("wp","FF575043"),
            new KeyValue("wpd","FF575043"),
            new KeyValue("wpg","FF575047"),
            new KeyValue("wri","31BE"),
            new KeyValue("WRI","31BE00"),
            new KeyValue("wri","32BE"),
            new KeyValue("ws","1D7D"),
            new KeyValue("XBE","584245"),
            new KeyValue("xdr","3C"),
            new KeyValue("xls","0902060000001000B9045C00"),
            new KeyValue("xls","0904060000001000F6055C00"),
            new KeyValue("XLS","D0CF11"),
            new KeyValue("xls","D0CF11E0"),
            new KeyValue("XML","3C3F78"),
            new KeyValue("xml","3C3F786D6C"),
            new KeyValue("xml","FFFE3C0052004F004F0054005300540055004200"),
            new KeyValue("XMV","005001"),
            new KeyValue("XSL","FFFE3C"),
            new KeyValue("xul","7273696F6E3D22313C3F786D6C2076652E30223F3E"),
            new KeyValue("z","1F9D"),
            new KeyValue("Z","1F9D8C"),
            new KeyValue("ZIP","504B03"),
            new KeyValue("zip","504B0304"),
            new KeyValue("zip","504B3030"),
            new KeyValue("Zip","504B3030504B0304"),
            new KeyValue("zoo","5A4F4F20")
        };
        public static string GetStreamType(Stream stream)
        {
            Byte[] Bytes = new Byte[4];
            stream.Read(Bytes, 0, Bytes.Length);
            string hex = BitConverter.ToString(Bytes).Replace("-", "");
            var FileType = FileList.Where(x => x.Value.Equals(hex)).FirstOrDefault();
            if (FileType == null)
                return "unknow";
            return FileType.Key;
        }
    }
}
